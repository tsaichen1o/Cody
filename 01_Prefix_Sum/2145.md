é€™é¡Œè¶…ç¶“å…¸ï¼Œæ˜¯å±¬æ–¼ **prefix sum + range fitting** çš„é‚è¼¯æ¨ç†é¡Œï¼Œä¾†ï¼Œæˆ‘å¹«ä½ æ•´ç†ç­†è¨˜ï¼Œç„¶å¾Œç”¨ C++ è§£å‡ºä¾†ï¼

---

### ğŸ“˜ é¡Œç›®: [Number of Valid Hidden Sequences](https://leetcode.com/problems/number-of-valid-words-for-each-puzzle/)  
### ğŸ“‚ é¡å‹: Prefix Sum, Sliding Window, Math  
### ğŸ§  é›£åº¦: Easy  
### ğŸ§© è§£æ³•:
- è¨­å®š hidden[0] ç‚ºä¸€å€‹æœªçŸ¥æ•¸ `x`ï¼Œå‰‡æ•´å€‹ hidden åºåˆ—å¯ä»¥ç”¨ differences é€é …æ¨å¾—ã€‚
- ç”¨ prefix sum `sums[i]` è¡¨ç¤º hidden[i] èˆ‡ hidden[0] çš„å·®å€¼ï¼Œå³ï¼š
  ```
  hidden[i] = x + prefixSum[i]
  ```
- é‚£æ•´å€‹åºåˆ—ä¸­çš„æœ€å°å€¼èˆ‡æœ€å¤§å€¼å°±æ˜¯ï¼š
  ```
  min_hidden = x + min(prefixSum)
  max_hidden = x + max(prefixSum)
  ```
- ç‚ºäº†ç¬¦åˆæ¢ä»¶ `[lower, upper]`ï¼Œå°±è¦è®“ï¼š
  ```
  lower <= x + min_prefix <= x + max_prefix <= upper
  => x âˆˆ [lower - min_prefix, upper - max_prefix]
  ```
- æ‰€ä»¥ x çš„åˆæ³•ç¯„åœé•·åº¦å°±æ˜¯ï¼š
  ```
  (upper - max_prefix) - (lower - min_prefix) + 1
  ```
- å¦‚æœç‚ºè² å€¼ï¼Œä»£è¡¨æ²’è§£ï¼Œreturn 0ã€‚

---

### âœ… C++ è§£æ³•å¦‚ä¸‹ï¼š

```cpp
class Solution {
public:
    int numberOfArrays(vector<int>& differences, int lower, int upper) {
        long long prefix = 0;
        long long min_prefix = 0, max_prefix = 0;
        
        for (int diff : differences) {
            prefix += diff;
            min_prefix = min(min_prefix, prefix);
            max_prefix = max(max_prefix, prefix);
        }
        
        long long min_start = lower - min_prefix;
        long long max_start = upper - max_prefix;
        
        long long possible_starts = max_start - min_start + 1;
        
        return possible_starts >= 0 ? possible_starts : 0;
    }
};
```

---

### ğŸ” å°æé†’ï¼š
- é€™é¡Œçš„é—œéµæ˜¯ã€Œprefix sum çš„ç¯„åœä¸æœƒå— x å½±éŸ¿ã€ï¼Œæ‰€ä»¥æˆ‘å€‘åªè¦ç®—å‡º `min` èˆ‡ `max` çš„è·é›¢ï¼Œå°±èƒ½æ±‚å‡ºæ‰€æœ‰å¯èƒ½çš„ xã€‚
- ä½¿ç”¨ `long long` æ˜¯ç‚ºäº†é¿å…å¤§æ•¸ overflowï¼ˆç‰¹åˆ¥æ˜¯ prefix sum ç´¯åŠ æœƒè¶…é `int`ï¼‰ã€‚

---

é›–ç„¶é€™é¡Œæœ€ç›´è§€ä¹Ÿæ˜¯æœ€å„ªè§£æ˜¯ç”¨æ•¸å­¸æ¨ç† + prefix sum ç¯„åœåšï¼Œä½†ä½ æƒ³çŸ¥é“ã€Œå¦‚æœä¸ç”¨æ•¸å­¸æ¨ç†ï¼Œå–®ç´”å¾ prefix sum çš„è§’åº¦æš´åŠ›æˆ–æ¨¡æ“¬åœ°æ€è€ƒæ€éº¼è§£ã€â€”â€”æˆ‘å¹«ä½ æ‹†è§£çœ‹çœ‹ ğŸ‘‡

---

### ğŸ§  æ¨¡æ“¬ + prefix sum è§£æ³•æ€è·¯ï¼ˆä¸å¥—æ•¸å­¸å…¬å¼ï¼‰

#### Step-by-stepï¼š

1. **æˆ‘å€‘çŸ¥é“ hidden[0] æ˜¯æœªçŸ¥çš„ï¼Œä½†ä¸€æ—¦ä½ çµ¦å®šä¸€å€‹èµ·é» xï¼Œæ•´å€‹åºåˆ—éƒ½å¯ä»¥è¢« differences æ¨å‡ºä¾†ã€‚**

2. æ‰€ä»¥æˆ‘å€‘å¯ä»¥å¾ `lower` åˆ° `upper` çš„æ‰€æœ‰å¯èƒ½èµ·é» x é–‹å§‹å˜—è©¦ï¼Œå°æ¯å€‹ xï¼š

   - åˆ©ç”¨ differences æ¨å‡ºæ•´å€‹ hidden åºåˆ—ã€‚
   - æª¢æŸ¥é€™å€‹åºåˆ—ä¸­æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½è½åœ¨ `[lower, upper]` ä¹‹å…§ã€‚
   - å¦‚æœåˆæ³•ï¼Œå°±è¨˜éŒ„ç‚ºä¸€ç¨®å¯è¡Œçš„ hidden åºåˆ—ã€‚

3. æœ€å¾Œå›å‚³ç¸½å…±æœ‰å¹¾ç¨®åˆæ³•çš„èµ·é»ã€‚

---

### âœ… æ¨¡æ“¬åšæ³• C++ ç¯„ä¾‹ï¼ˆä¸ç”¨æ•¸å­¸å…¬å¼ï¼‰

```cpp
class Solution {
public:
    int numberOfArrays(vector<int>& differences, int lower, int upper) {
        int count = 0;

        for (int start = lower; start <= upper; ++start) {
            long long current = start;
            bool isValid = true;

            for (int diff : differences) {
                current += diff;
                if (current < lower || current > upper) {
                    isValid = false;
                    break;
                }
            }

            if (isValid) count++;
        }

        return count;
    }
};
```

---

### ğŸ” æ™‚é–“è¤‡é›œåº¦ï¼š

- æœ€å·®æƒ…æ³ï¼š`(upper - lower + 1) * n`  
  ğŸ‘‰ è‹¥ `upper - lower â‰ˆ 2e5` ä¸” `n â‰ˆ 1e5`ï¼Œæœƒ **TLE**ï¼ˆè¶…æ™‚ï¼‰

---

### ğŸ’¡ ç¸½çµæ¯”è¼ƒï¼š

| æ–¹æ³• | è§£æ³•æ€è·¯ | æ™‚é–“è¤‡é›œåº¦ | å„ªé» | ç¼ºé» |
|------|-----------|-------------|------|------|
| æ¨¡æ“¬ï¼ˆä¸Šé¢é€™å€‹ï¼‰ | æšèˆ‰æ‰€æœ‰èµ·é» xï¼Œæ¨¡æ“¬åºåˆ— | O((upper - lower + 1) * n) | å¥½ç†è§£ã€ä¸ç”¨æ¨å…¬å¼ | æ•ˆç‡å¤ªå·®ï¼Œæœƒ TLE |
| æ•¸å­¸ + prefix sum | æ¨å‡º min/max prefixSum ç¯„åœï¼Œæ¨åˆæ³• x | O(n) | å¿«é€Ÿã€æœ‰æ•ˆç‡ | éœ€è¦æ¨ç†ç†è§£ |
